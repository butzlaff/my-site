{"ast":null,"code":"'use strict';\n\nconst Packets = require('../packets/index.js');\n\nconst Command = require('./command.js');\n\nconst CloseStatement = require('./close_statement.js');\n\nconst Execute = require('./execute.js');\n\nclass PreparedStatementInfo {\n  constructor(query, id, columns, parameters, connection) {\n    this.query = query;\n    this.id = id;\n    this.columns = columns;\n    this.parameters = parameters;\n    this.rowParser = null;\n    this._connection = connection;\n  }\n\n  close() {\n    return this._connection.addCommand(new CloseStatement(this.id));\n  }\n\n  execute(parameters, callback) {\n    if (typeof parameters === 'function') {\n      callback = parameters;\n      parameters = [];\n    }\n\n    return this._connection.addCommand(new Execute({\n      statement: this,\n      values: parameters\n    }, callback));\n  }\n\n}\n\nclass Prepare extends Command {\n  constructor(options, callback) {\n    super();\n    this.query = options.sql;\n    this.onResult = callback;\n    this.id = 0;\n    this.fieldCount = 0;\n    this.parameterCount = 0;\n    this.fields = [];\n    this.parameterDefinitions = [];\n    this.options = options;\n  }\n\n  start(packet, connection) {\n    const Connection = connection.constructor;\n    this.key = Connection.statementKey(this.options);\n\n    const statement = connection._statements.get(this.key);\n\n    if (statement) {\n      if (this.onResult) {\n        this.onResult(null, statement);\n      }\n\n      return null;\n    }\n\n    const cmdPacket = new Packets.PrepareStatement(this.query, connection.config.charsetNumber);\n    connection.writePacket(cmdPacket.toPacket(1));\n    return Prepare.prototype.prepareHeader;\n  }\n\n  prepareHeader(packet, connection) {\n    const header = new Packets.PreparedStatementHeader(packet);\n    this.id = header.id;\n    this.fieldCount = header.fieldCount;\n    this.parameterCount = header.parameterCount;\n\n    if (this.parameterCount > 0) {\n      return Prepare.prototype.readParameter;\n    }\n\n    if (this.fieldCount > 0) {\n      return Prepare.prototype.readField;\n    }\n\n    return this.prepareDone(connection);\n  }\n\n  readParameter(packet, connection) {\n    const def = new Packets.ColumnDefinition(packet, connection.clientEncoding);\n    this.parameterDefinitions.push(def);\n\n    if (this.parameterDefinitions.length === this.parameterCount) {\n      return Prepare.prototype.parametersEOF;\n    }\n\n    return this.readParameter;\n  }\n\n  readField(packet, connection) {\n    const def = new Packets.ColumnDefinition(packet, connection.clientEncoding);\n    this.fields.push(def);\n\n    if (this.fields.length === this.fieldCount) {\n      return Prepare.prototype.fieldsEOF;\n    }\n\n    return Prepare.prototype.readField;\n  }\n\n  parametersEOF(packet, connection) {\n    if (!packet.isEOF()) {\n      return connection.protocolError('Expected EOF packet after parameters');\n    }\n\n    if (this.fieldCount > 0) {\n      return Prepare.prototype.readField;\n    }\n\n    return this.prepareDone(connection);\n  }\n\n  fieldsEOF(packet, connection) {\n    if (!packet.isEOF()) {\n      return connection.protocolError('Expected EOF packet after fields');\n    }\n\n    return this.prepareDone(connection);\n  }\n\n  prepareDone(connection) {\n    const statement = new PreparedStatementInfo(this.query, this.id, this.fields, this.parameterDefinitions, connection);\n\n    connection._statements.set(this.key, statement);\n\n    if (this.onResult) {\n      this.onResult(null, statement);\n    }\n\n    return null;\n  }\n\n}\n\nmodule.exports = Prepare;","map":{"version":3,"names":["Packets","require","Command","CloseStatement","Execute","PreparedStatementInfo","constructor","query","id","columns","parameters","connection","rowParser","_connection","close","addCommand","execute","callback","statement","values","Prepare","options","sql","onResult","fieldCount","parameterCount","fields","parameterDefinitions","start","packet","Connection","key","statementKey","_statements","get","cmdPacket","PrepareStatement","config","charsetNumber","writePacket","toPacket","prototype","prepareHeader","header","PreparedStatementHeader","readParameter","readField","prepareDone","def","ColumnDefinition","clientEncoding","push","length","parametersEOF","fieldsEOF","isEOF","protocolError","set","module","exports"],"sources":["/home/emilio/Área de Trabalho/OneBitCode-aulas/REACT/site-react-login-live/react-controlledForms/node_modules/mysql2/lib/commands/prepare.js"],"sourcesContent":["'use strict';\n\nconst Packets = require('../packets/index.js');\nconst Command = require('./command.js');\nconst CloseStatement = require('./close_statement.js');\nconst Execute = require('./execute.js');\n\nclass PreparedStatementInfo {\n  constructor(query, id, columns, parameters, connection) {\n    this.query = query;\n    this.id = id;\n    this.columns = columns;\n    this.parameters = parameters;\n    this.rowParser = null;\n    this._connection = connection;\n  }\n\n  close() {\n    return this._connection.addCommand(new CloseStatement(this.id));\n  }\n\n  execute(parameters, callback) {\n    if (typeof parameters === 'function') {\n      callback = parameters;\n      parameters = [];\n    }\n    return this._connection.addCommand(\n      new Execute({ statement: this, values: parameters }, callback)\n    );\n  }\n}\n\nclass Prepare extends Command {\n  constructor(options, callback) {\n    super();\n    this.query = options.sql;\n    this.onResult = callback;\n    this.id = 0;\n    this.fieldCount = 0;\n    this.parameterCount = 0;\n    this.fields = [];\n    this.parameterDefinitions = [];\n    this.options = options;\n  }\n\n  start(packet, connection) {\n    const Connection = connection.constructor;\n    this.key = Connection.statementKey(this.options);\n    const statement = connection._statements.get(this.key);\n    if (statement) {\n      if (this.onResult) {\n        this.onResult(null, statement);\n      }\n      return null;\n    }\n    const cmdPacket = new Packets.PrepareStatement(\n      this.query,\n      connection.config.charsetNumber\n    );\n    connection.writePacket(cmdPacket.toPacket(1));\n    return Prepare.prototype.prepareHeader;\n  }\n\n  prepareHeader(packet, connection) {\n    const header = new Packets.PreparedStatementHeader(packet);\n    this.id = header.id;\n    this.fieldCount = header.fieldCount;\n    this.parameterCount = header.parameterCount;\n    if (this.parameterCount > 0) {\n      return Prepare.prototype.readParameter;\n    } if (this.fieldCount > 0) {\n      return Prepare.prototype.readField;\n    } \n    return this.prepareDone(connection);\n    \n  }\n\n  readParameter(packet, connection) {\n    const def = new Packets.ColumnDefinition(packet, connection.clientEncoding);\n    this.parameterDefinitions.push(def);\n    if (this.parameterDefinitions.length === this.parameterCount) {\n      return Prepare.prototype.parametersEOF;\n    }\n    return this.readParameter;\n  }\n\n  readField(packet, connection) {\n    const def = new Packets.ColumnDefinition(packet, connection.clientEncoding);\n    this.fields.push(def);\n    if (this.fields.length === this.fieldCount) {\n      return Prepare.prototype.fieldsEOF;\n    }\n    return Prepare.prototype.readField;\n  }\n\n  parametersEOF(packet, connection) {\n    if (!packet.isEOF()) {\n      return connection.protocolError('Expected EOF packet after parameters');\n    }\n    if (this.fieldCount > 0) {\n      return Prepare.prototype.readField;\n    } \n    return this.prepareDone(connection);\n    \n  }\n\n  fieldsEOF(packet, connection) {\n    if (!packet.isEOF()) {\n      return connection.protocolError('Expected EOF packet after fields');\n    }\n    return this.prepareDone(connection);\n  }\n\n  prepareDone(connection) {\n    const statement = new PreparedStatementInfo(\n      this.query,\n      this.id,\n      this.fields,\n      this.parameterDefinitions,\n      connection\n    );\n    connection._statements.set(this.key, statement);\n    if (this.onResult) {\n      this.onResult(null, statement);\n    }\n    return null;\n  }\n}\n\nmodule.exports = Prepare;\n"],"mappings":"AAAA;;AAEA,MAAMA,OAAO,GAAGC,OAAO,CAAC,qBAAD,CAAvB;;AACA,MAAMC,OAAO,GAAGD,OAAO,CAAC,cAAD,CAAvB;;AACA,MAAME,cAAc,GAAGF,OAAO,CAAC,sBAAD,CAA9B;;AACA,MAAMG,OAAO,GAAGH,OAAO,CAAC,cAAD,CAAvB;;AAEA,MAAMI,qBAAN,CAA4B;EAC1BC,WAAW,CAACC,KAAD,EAAQC,EAAR,EAAYC,OAAZ,EAAqBC,UAArB,EAAiCC,UAAjC,EAA6C;IACtD,KAAKJ,KAAL,GAAaA,KAAb;IACA,KAAKC,EAAL,GAAUA,EAAV;IACA,KAAKC,OAAL,GAAeA,OAAf;IACA,KAAKC,UAAL,GAAkBA,UAAlB;IACA,KAAKE,SAAL,GAAiB,IAAjB;IACA,KAAKC,WAAL,GAAmBF,UAAnB;EACD;;EAEDG,KAAK,GAAG;IACN,OAAO,KAAKD,WAAL,CAAiBE,UAAjB,CAA4B,IAAIZ,cAAJ,CAAmB,KAAKK,EAAxB,CAA5B,CAAP;EACD;;EAEDQ,OAAO,CAACN,UAAD,EAAaO,QAAb,EAAuB;IAC5B,IAAI,OAAOP,UAAP,KAAsB,UAA1B,EAAsC;MACpCO,QAAQ,GAAGP,UAAX;MACAA,UAAU,GAAG,EAAb;IACD;;IACD,OAAO,KAAKG,WAAL,CAAiBE,UAAjB,CACL,IAAIX,OAAJ,CAAY;MAAEc,SAAS,EAAE,IAAb;MAAmBC,MAAM,EAAET;IAA3B,CAAZ,EAAqDO,QAArD,CADK,CAAP;EAGD;;AAtByB;;AAyB5B,MAAMG,OAAN,SAAsBlB,OAAtB,CAA8B;EAC5BI,WAAW,CAACe,OAAD,EAAUJ,QAAV,EAAoB;IAC7B;IACA,KAAKV,KAAL,GAAac,OAAO,CAACC,GAArB;IACA,KAAKC,QAAL,GAAgBN,QAAhB;IACA,KAAKT,EAAL,GAAU,CAAV;IACA,KAAKgB,UAAL,GAAkB,CAAlB;IACA,KAAKC,cAAL,GAAsB,CAAtB;IACA,KAAKC,MAAL,GAAc,EAAd;IACA,KAAKC,oBAAL,GAA4B,EAA5B;IACA,KAAKN,OAAL,GAAeA,OAAf;EACD;;EAEDO,KAAK,CAACC,MAAD,EAASlB,UAAT,EAAqB;IACxB,MAAMmB,UAAU,GAAGnB,UAAU,CAACL,WAA9B;IACA,KAAKyB,GAAL,GAAWD,UAAU,CAACE,YAAX,CAAwB,KAAKX,OAA7B,CAAX;;IACA,MAAMH,SAAS,GAAGP,UAAU,CAACsB,WAAX,CAAuBC,GAAvB,CAA2B,KAAKH,GAAhC,CAAlB;;IACA,IAAIb,SAAJ,EAAe;MACb,IAAI,KAAKK,QAAT,EAAmB;QACjB,KAAKA,QAAL,CAAc,IAAd,EAAoBL,SAApB;MACD;;MACD,OAAO,IAAP;IACD;;IACD,MAAMiB,SAAS,GAAG,IAAInC,OAAO,CAACoC,gBAAZ,CAChB,KAAK7B,KADW,EAEhBI,UAAU,CAAC0B,MAAX,CAAkBC,aAFF,CAAlB;IAIA3B,UAAU,CAAC4B,WAAX,CAAuBJ,SAAS,CAACK,QAAV,CAAmB,CAAnB,CAAvB;IACA,OAAOpB,OAAO,CAACqB,SAAR,CAAkBC,aAAzB;EACD;;EAEDA,aAAa,CAACb,MAAD,EAASlB,UAAT,EAAqB;IAChC,MAAMgC,MAAM,GAAG,IAAI3C,OAAO,CAAC4C,uBAAZ,CAAoCf,MAApC,CAAf;IACA,KAAKrB,EAAL,GAAUmC,MAAM,CAACnC,EAAjB;IACA,KAAKgB,UAAL,GAAkBmB,MAAM,CAACnB,UAAzB;IACA,KAAKC,cAAL,GAAsBkB,MAAM,CAAClB,cAA7B;;IACA,IAAI,KAAKA,cAAL,GAAsB,CAA1B,EAA6B;MAC3B,OAAOL,OAAO,CAACqB,SAAR,CAAkBI,aAAzB;IACD;;IAAC,IAAI,KAAKrB,UAAL,GAAkB,CAAtB,EAAyB;MACzB,OAAOJ,OAAO,CAACqB,SAAR,CAAkBK,SAAzB;IACD;;IACD,OAAO,KAAKC,WAAL,CAAiBpC,UAAjB,CAAP;EAED;;EAEDkC,aAAa,CAAChB,MAAD,EAASlB,UAAT,EAAqB;IAChC,MAAMqC,GAAG,GAAG,IAAIhD,OAAO,CAACiD,gBAAZ,CAA6BpB,MAA7B,EAAqClB,UAAU,CAACuC,cAAhD,CAAZ;IACA,KAAKvB,oBAAL,CAA0BwB,IAA1B,CAA+BH,GAA/B;;IACA,IAAI,KAAKrB,oBAAL,CAA0ByB,MAA1B,KAAqC,KAAK3B,cAA9C,EAA8D;MAC5D,OAAOL,OAAO,CAACqB,SAAR,CAAkBY,aAAzB;IACD;;IACD,OAAO,KAAKR,aAAZ;EACD;;EAEDC,SAAS,CAACjB,MAAD,EAASlB,UAAT,EAAqB;IAC5B,MAAMqC,GAAG,GAAG,IAAIhD,OAAO,CAACiD,gBAAZ,CAA6BpB,MAA7B,EAAqClB,UAAU,CAACuC,cAAhD,CAAZ;IACA,KAAKxB,MAAL,CAAYyB,IAAZ,CAAiBH,GAAjB;;IACA,IAAI,KAAKtB,MAAL,CAAY0B,MAAZ,KAAuB,KAAK5B,UAAhC,EAA4C;MAC1C,OAAOJ,OAAO,CAACqB,SAAR,CAAkBa,SAAzB;IACD;;IACD,OAAOlC,OAAO,CAACqB,SAAR,CAAkBK,SAAzB;EACD;;EAEDO,aAAa,CAACxB,MAAD,EAASlB,UAAT,EAAqB;IAChC,IAAI,CAACkB,MAAM,CAAC0B,KAAP,EAAL,EAAqB;MACnB,OAAO5C,UAAU,CAAC6C,aAAX,CAAyB,sCAAzB,CAAP;IACD;;IACD,IAAI,KAAKhC,UAAL,GAAkB,CAAtB,EAAyB;MACvB,OAAOJ,OAAO,CAACqB,SAAR,CAAkBK,SAAzB;IACD;;IACD,OAAO,KAAKC,WAAL,CAAiBpC,UAAjB,CAAP;EAED;;EAED2C,SAAS,CAACzB,MAAD,EAASlB,UAAT,EAAqB;IAC5B,IAAI,CAACkB,MAAM,CAAC0B,KAAP,EAAL,EAAqB;MACnB,OAAO5C,UAAU,CAAC6C,aAAX,CAAyB,kCAAzB,CAAP;IACD;;IACD,OAAO,KAAKT,WAAL,CAAiBpC,UAAjB,CAAP;EACD;;EAEDoC,WAAW,CAACpC,UAAD,EAAa;IACtB,MAAMO,SAAS,GAAG,IAAIb,qBAAJ,CAChB,KAAKE,KADW,EAEhB,KAAKC,EAFW,EAGhB,KAAKkB,MAHW,EAIhB,KAAKC,oBAJW,EAKhBhB,UALgB,CAAlB;;IAOAA,UAAU,CAACsB,WAAX,CAAuBwB,GAAvB,CAA2B,KAAK1B,GAAhC,EAAqCb,SAArC;;IACA,IAAI,KAAKK,QAAT,EAAmB;MACjB,KAAKA,QAAL,CAAc,IAAd,EAAoBL,SAApB;IACD;;IACD,OAAO,IAAP;EACD;;AA9F2B;;AAiG9BwC,MAAM,CAACC,OAAP,GAAiBvC,OAAjB"},"metadata":{},"sourceType":"script"}
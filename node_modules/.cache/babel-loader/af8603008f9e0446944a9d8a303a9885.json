{"ast":null,"code":"var EventEmitter = require('events').EventEmitter;\n\nvar util = require('util');\n\nvar DEFAULT_TIMEOUT = 3000;\nvar INIT_ID = 0;\nvar EVENT_CLOSED = 'closed';\nvar EVENT_DRAINED = 'drained';\n/**\n * Instance a new queue\n *\n * @param {Number} timeout a global timeout for new queue\n * @class\n * @constructor\n */\n\nvar SeqQueue = function (timeout) {\n  EventEmitter.call(this);\n\n  if (timeout && timeout > 0) {\n    this.timeout = timeout;\n  } else {\n    this.timeout = DEFAULT_TIMEOUT;\n  }\n\n  this.status = SeqQueueManager.STATUS_IDLE;\n  this.curId = INIT_ID;\n  this.queue = [];\n};\n\nutil.inherits(SeqQueue, EventEmitter);\n/**\n * Add a task into queue.\n * \n * @param fn new request\n * @param ontimeout callback when task timeout\n * @param timeout timeout for current request. take the global timeout if this is invalid\n * @returns true or false\n */\n\nSeqQueue.prototype.push = function (fn, ontimeout, timeout) {\n  if (this.status !== SeqQueueManager.STATUS_IDLE && this.status !== SeqQueueManager.STATUS_BUSY) {\n    //ignore invalid status\n    return false;\n  }\n\n  if (typeof fn !== 'function') {\n    throw new Error('fn should be a function.');\n  }\n\n  this.queue.push({\n    fn: fn,\n    ontimeout: ontimeout,\n    timeout: timeout\n  });\n\n  if (this.status === SeqQueueManager.STATUS_IDLE) {\n    this.status = SeqQueueManager.STATUS_BUSY;\n    var self = this;\n    process.nextTick(function () {\n      self._next(self.curId);\n    });\n  }\n\n  return true;\n};\n/**\n * Close queue\n * \n * @param {Boolean} force if true will close the queue immediately else will execute the rest task in queue\n */\n\n\nSeqQueue.prototype.close = function (force) {\n  if (this.status !== SeqQueueManager.STATUS_IDLE && this.status !== SeqQueueManager.STATUS_BUSY) {\n    //ignore invalid status\n    return;\n  }\n\n  if (force) {\n    this.status = SeqQueueManager.STATUS_DRAINED;\n\n    if (this.timerId) {\n      clearTimeout(this.timerId);\n      this.timerId = undefined;\n    }\n\n    this.emit(EVENT_DRAINED);\n  } else {\n    this.status = SeqQueueManager.STATUS_CLOSED;\n    this.emit(EVENT_CLOSED);\n  }\n};\n/**\n * Invoke next task\n * \n * @param {String|Number} tid last executed task id\n * @api private\n */\n\n\nSeqQueue.prototype._next = function (tid) {\n  if (tid !== this.curId || this.status !== SeqQueueManager.STATUS_BUSY && this.status !== SeqQueueManager.STATUS_CLOSED) {\n    //ignore invalid next call\n    return;\n  }\n\n  if (this.timerId) {\n    clearTimeout(this.timerId);\n    this.timerId = undefined;\n  }\n\n  var task = this.queue.shift();\n\n  if (!task) {\n    if (this.status === SeqQueueManager.STATUS_BUSY) {\n      this.status = SeqQueueManager.STATUS_IDLE;\n      this.curId++; //modify curId to invalidate timeout task\n    } else {\n      this.status = SeqQueueManager.STATUS_DRAINED;\n      this.emit(EVENT_DRAINED);\n    }\n\n    return;\n  }\n\n  var self = this;\n  task.id = ++this.curId;\n  var timeout = task.timeout > 0 ? task.timeout : this.timeout;\n  timeout = timeout > 0 ? timeout : DEFAULT_TIMEOUT;\n  this.timerId = setTimeout(function () {\n    process.nextTick(function () {\n      self._next(task.id);\n    });\n    self.emit('timeout', task);\n\n    if (task.ontimeout) {\n      task.ontimeout();\n    }\n  }, timeout);\n\n  try {\n    task.fn({\n      done: function () {\n        var res = task.id === self.curId;\n        process.nextTick(function () {\n          self._next(task.id);\n        });\n        return res;\n      }\n    });\n  } catch (err) {\n    self.emit('error', err, task);\n    process.nextTick(function () {\n      self._next(task.id);\n    });\n  }\n};\n/**\n * Queue manager.\n * \n * @module\n */\n\n\nvar SeqQueueManager = module.exports;\n/**\n * Queue status: idle, welcome new tasks\n *\n * @const\n * @type {Number}\n * @memberOf SeqQueueManager\n */\n\nSeqQueueManager.STATUS_IDLE = 0;\n/**\n * Queue status: busy, queue is working for some tasks now\n *\n * @const\n * @type {Number}\n * @memberOf SeqQueueManager\n */\n\nSeqQueueManager.STATUS_BUSY = 1;\n/**\n * Queue status: closed, queue has closed and would not receive task any more \n * \t\t\t\t\tand is processing the remaining tasks now.\n *\n * @const\n * @type {Number}\n * @memberOf SeqQueueManager\n */\n\nSeqQueueManager.STATUS_CLOSED = 2;\n/**\n * Queue status: drained, queue is ready to be destroy\n *\n * @const\n * @type {Number}\n * @memberOf SeqQueueManager\n */\n\nSeqQueueManager.STATUS_DRAINED = 3;\n/**\n * Create Sequence queue\n * \n * @param  {Number} timeout a global timeout for the new queue instance\n * @return {Object}         new queue instance\n * @memberOf SeqQueueManager\n */\n\nSeqQueueManager.createQueue = function (timeout) {\n  return new SeqQueue(timeout);\n};","map":{"version":3,"names":["EventEmitter","require","util","DEFAULT_TIMEOUT","INIT_ID","EVENT_CLOSED","EVENT_DRAINED","SeqQueue","timeout","call","status","SeqQueueManager","STATUS_IDLE","curId","queue","inherits","prototype","push","fn","ontimeout","STATUS_BUSY","Error","self","process","nextTick","_next","close","force","STATUS_DRAINED","timerId","clearTimeout","undefined","emit","STATUS_CLOSED","tid","task","shift","id","setTimeout","done","res","err","module","exports","createQueue"],"sources":["/home/emilio/Ãrea de Trabalho/OneBitCode-aulas/REACT/site-react-login-live/react-controlledForms/node_modules/seq-queue/lib/seq-queue.js"],"sourcesContent":["var EventEmitter = require('events').EventEmitter;\nvar util = require('util');\n\nvar DEFAULT_TIMEOUT = 3000;\nvar INIT_ID = 0;\nvar EVENT_CLOSED = 'closed';\nvar EVENT_DRAINED = 'drained';\n\n/**\n * Instance a new queue\n *\n * @param {Number} timeout a global timeout for new queue\n * @class\n * @constructor\n */\nvar SeqQueue = function(timeout) {\n\tEventEmitter.call(this);\n\t\n\tif(timeout && timeout > 0) {\n\t\tthis.timeout = timeout;\n\t} else {\n\t\tthis.timeout = DEFAULT_TIMEOUT;\n\t}\n\t\n\tthis.status = SeqQueueManager.STATUS_IDLE;\n\tthis.curId = INIT_ID;\n\tthis.queue = [];\n};\nutil.inherits(SeqQueue, EventEmitter);\n\n/**\n * Add a task into queue.\n * \n * @param fn new request\n * @param ontimeout callback when task timeout\n * @param timeout timeout for current request. take the global timeout if this is invalid\n * @returns true or false\n */\nSeqQueue.prototype.push = function(fn, ontimeout, timeout) {\n\tif(this.status !== SeqQueueManager.STATUS_IDLE && this.status !== SeqQueueManager.STATUS_BUSY) {\n\t\t//ignore invalid status\n\t\treturn false;\n\t}\n\t\n\tif(typeof fn !== 'function') {\n\t\tthrow new Error('fn should be a function.');\n\t}\n\tthis.queue.push({fn: fn, ontimeout: ontimeout, timeout: timeout});\n\n\tif(this.status === SeqQueueManager.STATUS_IDLE) {\n\t\tthis.status = SeqQueueManager.STATUS_BUSY;\n\t\tvar self = this;\n\t\tprocess.nextTick(function() {\n\t\t\tself._next(self.curId);\n\t\t});\n\t}\n\treturn true;\n};\n\n/**\n * Close queue\n * \n * @param {Boolean} force if true will close the queue immediately else will execute the rest task in queue\n */\nSeqQueue.prototype.close = function(force) {\n\tif(this.status !== SeqQueueManager.STATUS_IDLE && this.status !== SeqQueueManager.STATUS_BUSY) {\n\t\t//ignore invalid status\n\t\treturn;\n\t}\n\t\n\tif(force) {\n\t\tthis.status = SeqQueueManager.STATUS_DRAINED;\n\t\tif(this.timerId) {\n\t\t\tclearTimeout(this.timerId);\n\t\t\tthis.timerId = undefined;\n\t\t}\n\t\tthis.emit(EVENT_DRAINED);\n\t} else {\n\t\tthis.status = SeqQueueManager.STATUS_CLOSED;\n\t\tthis.emit(EVENT_CLOSED);\n\t}\n};\n\n/**\n * Invoke next task\n * \n * @param {String|Number} tid last executed task id\n * @api private\n */\nSeqQueue.prototype._next = function(tid) {\n\tif(tid !== this.curId || this.status !== SeqQueueManager.STATUS_BUSY && this.status !== SeqQueueManager.STATUS_CLOSED) {\n\t\t//ignore invalid next call\n\t\treturn;\n\t}\n\t\n\tif(this.timerId) {\n\t\tclearTimeout(this.timerId);\n\t\tthis.timerId = undefined;\n\t}\n\t\n\tvar task = this.queue.shift();\n\tif(!task) {\n\t\tif(this.status === SeqQueueManager.STATUS_BUSY) {\n\t\t\tthis.status = SeqQueueManager.STATUS_IDLE;\n\t\t\tthis.curId++;\t//modify curId to invalidate timeout task\n\t\t} else {\n\t\t\tthis.status = SeqQueueManager.STATUS_DRAINED;\n\t\t\tthis.emit(EVENT_DRAINED);\n\t\t}\n\t\treturn;\n\t}\n\t\n\tvar self = this;\n\ttask.id = ++this.curId;\n\n\tvar timeout = task.timeout > 0 ? task.timeout : this.timeout;\n\ttimeout = timeout > 0 ? timeout : DEFAULT_TIMEOUT;\n\tthis.timerId = setTimeout(function() {\n\t\tprocess.nextTick(function() {\n\t\t\tself._next(task.id);\n\t\t});\n\t\tself.emit('timeout', task);\n\t\tif(task.ontimeout) {\n\t\t\ttask.ontimeout();\n\t\t}\n\t}, timeout);\n\n\ttry {\n\t\ttask.fn({\n\t\t\tdone: function() {\n\t\t\t\tvar res = task.id === self.curId;\n\t\t\t\tprocess.nextTick(function() {\n\t\t\t\t\tself._next(task.id);\n\t\t\t\t});\n\t\t\t\treturn res;\n\t\t\t}\n\t\t});\n\t} catch(err) {\n\t\tself.emit('error', err, task);\n\t\tprocess.nextTick(function() {\n\t\t\tself._next(task.id);\n\t\t});\n\t}\n};\n\n/**\n * Queue manager.\n * \n * @module\n */\nvar SeqQueueManager = module.exports;\n\n/**\n * Queue status: idle, welcome new tasks\n *\n * @const\n * @type {Number}\n * @memberOf SeqQueueManager\n */\nSeqQueueManager.STATUS_IDLE = 0;\n\n/**\n * Queue status: busy, queue is working for some tasks now\n *\n * @const\n * @type {Number}\n * @memberOf SeqQueueManager\n */\nSeqQueueManager.STATUS_BUSY = 1;\n\n/**\n * Queue status: closed, queue has closed and would not receive task any more \n * \t\t\t\t\tand is processing the remaining tasks now.\n *\n * @const\n * @type {Number}\n * @memberOf SeqQueueManager\n */\nSeqQueueManager.STATUS_CLOSED = 2; \n\n/**\n * Queue status: drained, queue is ready to be destroy\n *\n * @const\n * @type {Number}\n * @memberOf SeqQueueManager\n */\nSeqQueueManager.STATUS_DRAINED = 3;\n\n/**\n * Create Sequence queue\n * \n * @param  {Number} timeout a global timeout for the new queue instance\n * @return {Object}         new queue instance\n * @memberOf SeqQueueManager\n */\nSeqQueueManager.createQueue = function(timeout) {\n\treturn new SeqQueue(timeout);\n};"],"mappings":"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"},"metadata":{},"sourceType":"script"}